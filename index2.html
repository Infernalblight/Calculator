<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lifting Simulator Calculator</title>

<style>
body{
  font-family: system-ui, Arial, sans-serif;
  background:#0b0f1a;
  color:#e8ebff;
  margin:0;
  padding:30px;
}
.card{
  max-width:900px;
  margin:auto;
  background:#12172a;
  padding:24px;
  border-radius:18px;
  box-shadow:0 30px 80px rgba(0,0,0,.5);
}
h1{margin-top:0}
input,select,button{
  width:100%;
  padding:10px;
  margin:6px 0 14px 0;
  border-radius:10px;
  border:none;
  outline:none;
  font-size:15px;
}
input,select{background:#0b0f1a;color:#e8ebff}
button{
  background:#7c9cff;
  color:#0b0f1a;
  font-weight:700;
  cursor:pointer;
}
button:hover{opacity:.85}
.row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
label{font-size:14px;opacity:.85}
#result{
  margin-top:18px;
  background:#0b0f1a;
  padding:18px;
  border-radius:14px;
  line-height:1.55;
}
.small{opacity:.75;font-size:13px}
.checks label{display:block}
</style>
</head>

<body>
<div class="card">
<h1>Lifting Simulator Calculator</h1>

<div class="row">
<div>
<label>Weight</label>
<select id="weightSelect"></select>
</div>
<div>
<label>Stage</label>
<select id="stageSelect"></select>
</div>
</div>

<div class="checks">
<label><input type="checkbox" id="doubleMuscles"> 2× Muscles</label>
<label><input type="checkbox" id="fasterLifter"> Faster Lifter</label>
<label><input type="checkbox" id="doubleCoins"> 2× Coins</label>
</div>

<div class="row">
<div>
<label>Already Have Muscles</label>
<input id="ownedMuscles" placeholder="e.g. 2.5Qi">
</div>
<div>
<label>Already Have Coins</label>
<input id="ownedCoins" placeholder="e.g. 1T">
</div>
</div>

<button id="calculateBtn">Calculate</button>
<div id="result"></div>
</div>

<script>
const weightsURL = "https://liftingsimulatorcalculator.netlify.app/weights.json"
const stagesURL  = "https://liftingsimulatorcalculator.netlify.app/stages.json"

let weights=[], stages=[]

const suffixes = [
["M",6],["B",9],["T",12],["Qa",15],["Qi",18],["Sx",21],["Sp",24],["Oc",27],["No",30],["Dc",33],
["Ud",36],["Dd",39],["Td",42],["Qad",45],["Qid",48],["Sxd",51],["Spd",54],["Ocd",57],["Nod",60],["Vg",63],
["Uvg",66],["Dvg",69],["Tvg",72],["Qavg",75],["Qivg",78],["Sxvg",81],["Spvg",84],["Ocvg",87],["Novg",90],["Tg",93],
["Utg",96],["Dtg",99],["Ttg",102],["Qatg",105],["Qitg",108],["Sxtg",111],["Sptg",114],["Octg",117],["Notg",120],["Ag",123],
["Uag",126],["Dag",129],["Tag",132],["Qaag",135],["Qiag",138],["Sxag",141],["Spag",144],["Ocag",147],["Noag",150],["Dcag",153],
["Udag",156],["Ddag",159],["Tdag",162],["Qaag",165],["Uqag",168],["Dqag",171],["Tqag",174],["Qaqag",177],["Qiqag",180],["Sxqag",183],
["Spqag",186],["Ocqag",189],["Noqag",192],["Dcqag",195],["Udqag",198],["Ddqag",201],["Tdqag",204],["Qig",207],["Uqig",210],["Dqig",213],
["Tqig",216],["QaQig",219],["Qiqig",222],["Sxqig",225],["Spqig",228],["Ocqig",231],["Noqig",234],["Dcqig",237],["Udqig",240],["Ddqig",243],
["Tdqig",246],["Sxg",249],["Usxg",252],["Dxsxg",255],["Tsxg",258],["Qasxg",261],["Qisxg",264],["Sxsxg",267],["Spsxg",270],["Ocsxg",273],
["Nosxg",276],["Dcsxg",279],["Udsxg",282],["Ddsxg",285],["Tdsxg",288],["Spg",291],["Uspg",294],["Dspg",297],["Tspg",300],["Qaspg",303],["Qispg",306]
]

async function loadData(){
  const [w,s]=await Promise.all([fetch(weightsURL),fetch(stagesURL)])
  weights=await w.json()
  stages=await s.json()
  populate()
}

function populate(){
  weightSelect.innerHTML=""
  stageSelect.innerHTML=""

  stages.sort((a,b)=>a.n-b.n)
  weights.sort((a,b)=>a.cost-b.cost)

  for(const st of stages){
    const o=document.createElement("option")
    o.value=st.n
    o.text=`Stage ${st.n}`
    stageSelect.appendChild(o)
  }

  for(const w of weights){
    const o=document.createElement("option")
    o.value=w.name
    o.text=`${w.name} | Cost ${formatNum(w.cost)} | Gain ${w.gain}`
    weightSelect.appendChild(o)
  }
}

function parseNum(str){
  if(!str)return 0
  str=str.replace(/,/g,"").trim()
  for(const [s,p] of suffixes){
    if(str.toUpperCase().endsWith(s.toUpperCase()))
      return parseFloat(str)*10**p
  }
  return parseFloat(str)||0
}

function formatNum(n){
  if(!isFinite(n))return "∞"
  for(let i=suffixes.length-1;i>=0;i--){
    if(n>=10**suffixes[i][1])
      return (n/10**suffixes[i][1]).toFixed(2)+suffixes[i][0]
  }
  if(n>=1e3)return (n/1e3).toFixed(2)+"K"
  return n.toFixed(2)
}

function humanTime(sec){
  if(!isFinite(sec))return "∞"
  if(sec<60)return sec.toFixed(2)+"s"
  sec/=60
  if(sec<60)return sec.toFixed(2)+"m"
  sec/=60
  if(sec<24)return sec.toFixed(2)+"h"
  sec/=24
  if(sec<365)return sec.toFixed(2)+"d"
  return (sec/365).toFixed(2)+"y"
}

function calculate(){
  const weight=weights.find(w=>w.name===weightSelect.value)
  const stage=stages.find(s=>s.n==stageSelect.value)

  const ownedMuscles=parseNum(ownedMusclesInput.value)
  const ownedCoins=parseNum(ownedCoinsInput.value)

  let gain=parseNum(weight.gain)
  gain*=stage.gainMultiplier

  if(doubleMuscles.checked)gain*=2

  let perSecond=gain*stage.m
  if(fasterLifter.checked)perSecond*=2

  let coinsPerSecond=perSecond
  if(doubleCoins.checked)coinsPerSecond*=2

  const nextWeight=weights.find(w=>w.cost>ownedCoins)
  const nextStage=stages.find(s=>s.n>stage.n)

  const timeToWeight=nextWeight?(nextWeight.cost-ownedCoins)/coinsPerSecond:Infinity
  const timeToStage=nextStage?((weights.filter(w=>w.stage==nextStage.n)[0]?.cost||Infinity)-ownedCoins)/coinsPerSecond:Infinity

  result.innerHTML=`
<b>Muscles per lift:</b> ${formatNum(gain)}<br>
<b>Muscles per second:</b> ${formatNum(perSecond)}<br><br>

<b>Coins per second:</b> ${formatNum(coinsPerSecond)}<br>
<b>Time to next weight:</b> ${humanTime(timeToWeight)}<br>
<b>Time to next stage:</b> ${humanTime(timeToStage)}<br><br>

<span class="small">
Stage multiplier: x${stage.gainMultiplier}<br>
Lifts/sec: ${stage.m}
</span>
`
}

const ownedMusclesInput=document.getElementById("ownedMuscles")
const ownedCoinsInput=document.getElementById("ownedCoins")

calculateBtn.onclick=calculate
loadData()
</script>
</body>
</html>
