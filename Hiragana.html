<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hiragana Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
margin:0;
min-height:100vh;
display:flex;
align-items:center;
justify-content:center;
background:#0b0f1a;
color:white;
font-family:system-ui,Arial,sans-serif
}
.app{
background:#12172a;
padding:24px;
border-radius:20px;
box-shadow:0 20px 60px rgba(0,0,0,.5);
width:360px;
text-align:center
}
.top{
display:flex;
gap:8px;
margin-bottom:10px
}
.top button{
flex:1;
padding:10px;
border:none;
border-radius:10px;
font-weight:700;
background:#1b2140;
color:white
}
.top button.active{
background:#7c9cff;
color:#0b0f1a
}
.settings{
display:flex;
gap:8px;
margin-bottom:12px
}
.settings input{
flex:1;
padding:10px;
border-radius:10px;
border:none;
font-size:14px;
text-align:center
}
.settings button{
padding:10px 14px;
border:none;
border-radius:10px;
background:#1b2140;
color:white;
font-weight:700
}
.char{
font-size:96px;
margin:14px 0
}
.meaning{
font-size:22px;
min-height:28px;
opacity:.9
}
input.answer{
width:100%;
padding:12px;
border-radius:10px;
border:none;
outline:none;
font-size:18px;
text-align:center;
margin-top:10px
}
button.main{
margin-top:12px;
padding:12px;
width:100%;
border:none;
border-radius:10px;
font-size:16px;
background:#7c9cff;
color:#0b0f1a;
font-weight:700
}
.row{
display:flex;
gap:8px;
margin-top:10px
}
.row button{
flex:1;
padding:10px;
border:none;
border-radius:10px;
font-size:14px;
background:#1b2140;
color:white
}
.result{
margin-top:10px;
min-height:24px;
font-size:18px
}
.correct{color:#5bffb0}
.wrong{color:#ff6b6b}
.hidden{display:none}
</style>
</head>
<body>
<div class="app">
<div class="top">
<button id="quizBtn" class="active">Quiz</button>
<button id="studyBtn">Study</button>
</div>

<div class="settings">
<input id="countInput" type="number" min="1" max="46" value="46">
<button id="applyBtn">Apply</button>
</div>

<div class="char" id="char">あ</div>
<div class="meaning" id="meaning"></div>

<input id="answer" class="answer" placeholder="type romaji">

<button class="main" id="mainBtn">Submit</button>

<div class="row" id="quizRow">
<button id="hintBtn">Hint</button>
<button id="showBtn">Show Answer</button>
</div>

<div class="result" id="result"></div>
</div>

<script>
const allHiragana = [
["あ","a"],["い","i"],["う","u"],["え","e"],["お","o"],
["か","ka"],["き","ki"],["く","ku"],["け","ke"],["こ","ko"],
["さ","sa"],["し","shi"],["す","su"],["せ","se"],["そ","so"],
["た","ta"],["ち","chi"],["つ","tsu"],["て","te"],["と","to"],
["な","na"],["に","ni"],["ぬ","nu"],["ね","ne"],["の","no"],
["は","ha"],["ひ","hi"],["ふ","fu"],["へ","he"],["ほ","ho"],
["ま","ma"],["み","mi"],["む","mu"],["め","me"],["も","mo"],
["や","ya"],["ゆ","yu"],["よ","yo"],
["ら","ra"],["り","ri"],["る","ru"],["れ","re"],["ろ","ro"],
["わ","wa"],["を","wo"],["ん","n"]
];

let pool = [...allHiragana];
let current = null;
let mode = "quiz";

const charEl = document.getElementById("char");
const meaningEl = document.getElementById("meaning");
const answerEl = document.getElementById("answer");
const resultEl = document.getElementById("result");
const mainBtn = document.getElementById("mainBtn");
const quizRow = document.getElementById("quizRow");
const quizBtn = document.getElementById("quizBtn");
const studyBtn = document.getElementById("studyBtn");
const countInput = document.getElementById("countInput");
const applyBtn = document.getElementById("applyBtn");

function shuffle(arr){
for(let i=arr.length-1;i>0;i--){
const j=Math.floor(Math.random()*(i+1));
[arr[i],arr[j]]=[arr[j],arr[i]];
}
return arr;
}

function rebuildPool(){
let n = parseInt(countInput.value);
if(isNaN(n) || n<1) n=1;
if(n>allHiragana.length) n=allHiragana.length;
pool = shuffle([...allHiragana]).slice(0,n);
if(mode==="quiz") randomChar();
else showStudy();
}

function randomChar(){
current = pool[Math.floor(Math.random()*pool.length)];
charEl.textContent = current[0];
meaningEl.textContent = "";
answerEl.value = "";
resultEl.textContent = "";
answerEl.focus();
}

function submitQuiz(){
const val = answerEl.value.trim().toLowerCase();
if(val === current[1]){
resultEl.textContent = "Correct";
resultEl.className = "result correct";
setTimeout(randomChar,700);
}else{
resultEl.textContent = "Wrong ("+current[1]+")";
resultEl.className = "result wrong";
setTimeout(randomChar,900);
}
}

function showStudy(){
current = pool[Math.floor(Math.random()*pool.length)];
charEl.textContent = current[0];
meaningEl.textContent = current[1];
resultEl.textContent = "";
}

function setMode(m){
mode = m;
quizBtn.classList.remove("active");
studyBtn.classList.remove("active");
if(m==="quiz"){
quizBtn.classList.add("active");
answerEl.classList.remove("hidden");
quizRow.classList.remove("hidden");
mainBtn.textContent = "Submit";
meaningEl.textContent = "";
randomChar();
}else{
studyBtn.classList.add("active");
answerEl.classList.add("hidden");
quizRow.classList.add("hidden");
mainBtn.textContent = "Next";
showStudy();
}
}

document.getElementById("hintBtn").onclick = ()=>{
if(!current) return;
meaningEl.textContent = current[1][0] + "...";
};

document.getElementById("showBtn").onclick = ()=>{
if(!current) return;
meaningEl.textContent = current[1];
};

mainBtn.onclick = ()=>{
if(mode==="quiz") submitQuiz();
else showStudy();
};

answerEl.addEventListener("keydown",e=>{
if(e.key==="Enter" && mode==="quiz") submitQuiz();
});

quizBtn.onclick = ()=>setMode("quiz");
studyBtn.onclick = ()=>setMode("study");
applyBtn.onclick = rebuildPool;

rebuildPool();
</script>
</body>
</html>
